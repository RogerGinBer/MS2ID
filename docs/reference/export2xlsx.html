<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Export an annotation object to an xlsx file — export2xlsx • MS2ID</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Export an annotation object to an xlsx file — export2xlsx" />
<meta property="og:description" content="export2xlsx function exports the data contained in an
Annot object to a xlsx file." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MS2ID</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MS2ID.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/annotate.html">Annotate query spectra</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jmbadia/MS2ID/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Export an annotation object to an xlsx file</h1>
    <small class="dont-index">Source: <a href='https://github.com/jmbadia/MS2ID/blob/master/R/export2xlsx.R'><code>R/export2xlsx.R</code></a></small>
    <div class="hidden name"><code>export2xlsx.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>export2xlsx</code> function exports the data contained in an
<a href='Annot.html'>Annot</a> object to a xlsx file.</p>
    </div>

    <pre class="usage"><span class='fu'>export2xlsx</span><span class='op'>(</span><span class='va'>anRslt</span>, file <span class='op'>=</span> <span class='cn'>NULL</span>, summarizeHits <span class='op'>=</span> <span class='cn'>TRUE</span>, overwrite <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>anRslt</th>
      <td><p><a href='Annot.html'>Annot</a> object with the results to export.</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>char(1) name of the resulting xlsx file</p></td>
    </tr>
    <tr>
      <th>summarizeHits</th>
      <td><p>boolean(1). A TRUE value summarizes the resulting excel,
keeping only, for every query spectrum, the best annotation per compound.</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>boolean(1) If TRUE, overwrite any existing file.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passed to function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>export2xlsx</code> function distributes the annotation results among
different worksheets of an xlsx file, one per query file, and every row
corresponds to an annotation. Annotations of the same query spectrum have
identical row colours. Contiguous annotations with equal query precursor mass
have similar row colours (e.g. variations of orange); the best distance
metric and the most common compound name among those contiguous annotations
are bolded in red and black. Moreover:</p><ul>
<li><p>The column
<code>massNum.QRY_CMN_REF</code> (e.g. 7/4/5) shows the number of fragments of the
query and reference spectra, and the number of fragments they have in common.</p></li>
<li><p><code>REFinchikey</code> contains the inchikey of the reference compound and
a link to a Pubchem's page listing compounds with that inchikey.</p></li>
<li><p><code>ppmPrecMass</code> refers to the absolute difference value in ppm between
query and reference precursor masses.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='Annot.html'>Annot</a> class and <code><a href='annotate.html'>annotate</a></code> function.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Josep M. Badia <a href='mailto:josepmaria.badia@urv.cat'>josepmaria.badia@urv.cat</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## LOAD MS2ID LIBRARY ---</span>
<span class='co'>## Decompress the MS2ID library that comes with MS2ID</span>
<span class='va'>MS2IDzipFile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/MS2IDLibrary.zip"</span>,
                            package <span class='op'>=</span> <span class='st'>"MS2ID"</span>,
                            mustWork <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>utils</span><span class='op'>)</span>
<span class='va'>MS2IDFolder</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/basename.html'>dirname</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/unzip.html'>unzip</a></span><span class='op'>(</span><span class='va'>MS2IDzipFile</span>,
                             exdir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

<span class='co'>## SELECT QUERY SPECTRA ---</span>
<span class='co'>## Decompress the query mzML files that come with MS2ID</span>
<span class='va'>queryFile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/QRYspectra.zip"</span>,
                         package <span class='op'>=</span> <span class='st'>"MS2ID"</span>,
                         mustWork <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>queryFolder</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"QRYspectra"</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>utils</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/unzip.html'>unzip</a></span><span class='op'>(</span><span class='va'>queryFile</span>, exdir <span class='op'>=</span> <span class='va'>queryFolder</span><span class='op'>)</span>

<span class='co'>## ANNOTATION ---</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://jmbadia.github.io/MS2ID/index.html'>MS2ID</a></span><span class='op'>)</span>
<span class='va'>MS2IDlib</span> <span class='op'>&lt;-</span> <span class='fu'><a href='MS2ID.html'>MS2ID</a></span><span class='op'>(</span><span class='va'>MS2IDFolder</span><span class='op'>)</span>
<span class='va'>annotResult</span> <span class='op'>&lt;-</span> <span class='fu'><a href='annotate.html'>annotate</a></span><span class='op'>(</span>QRYdata <span class='op'>=</span> <span class='va'>queryFolder</span>, MS2ID <span class='op'>=</span> <span class='va'>MS2IDlib</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading query spectra ...</span></div><div class='output co'>#&gt; <span class='message'>Obtaining consensus spectra ...</span></div><div class='output co'>#&gt; <span class='message'>Solving distance metrics between query and reference spectra ...</span></div><div class='output co'>#&gt; <span class='message'>Processing results obtained ...</span></div><div class='input'>
<span class='co'>## EXPORT TO XLSX FILE---</span>
<span class='fu'>export2xlsx</span><span class='op'>(</span>anRslt <span class='op'>=</span> <span class='va'>annotResult</span>, file <span class='op'>=</span> <span class='st'>"sample"</span>,
            summarizeHits <span class='op'>=</span> <span class='cn'>FALSE</span>, overwrite<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Josep M. Badia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


